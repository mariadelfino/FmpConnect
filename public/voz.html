<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="SenaChat - Converse por voz com seu assistente virtual">
    <meta name="theme-color" content="#3B018A">
    <title>SenaChat - Conversa por Voz</title>
    
    <!-- Script Crítico de Acessibilidade - DEVE vir ANTES de tudo para evitar flash -->
    <script>
        (function() {
            try {
                const saved = localStorage.getItem('senachat-acessibilidade');
                if (saved) {
                    const estado = JSON.parse(saved);
                    
                    // Aplica tema IMEDIATAMENTE
                    if (estado.tema === 'claro') {
                        document.documentElement.setAttribute('data-theme', 'light');
                    }
                    
                    // Aplica escala de fonte
                    if (estado.scaleFactor && estado.scaleFactor !== 1) {
                        document.documentElement.style.setProperty('--scale-factor', estado.scaleFactor);
                    }
                    
                    // Prepara classes de filtro no MAIN (não no body para evitar quebrar position:fixed)
                    document.addEventListener('DOMContentLoaded', function() {
                        const mains = document.querySelectorAll('main');
                        
                        if (estado.filtroDaltonismo && estado.filtroDaltonismo !== 'none') {
                            mains.forEach(function(main) {
                                main.classList.add('filtro-' + estado.filtroDaltonismo);
                            });
                            document.body.setAttribute('data-filtro-daltonismo', estado.filtroDaltonismo);
                        }
                        
                        if (estado.contraste) {
                            mains.forEach(function(main) {
                                main.classList.add('alto-contraste');
                            });
                            document.body.setAttribute('data-alto-contraste', 'true');
                        }
                    });
                }
            } catch (e) {
                // Silently fail - não quebrar a página
            }
        })();
    </script>
    
    <!-- Google Fonts - Montserrat -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="./assets/css/componentes.css">
    <link rel="stylesheet" href="./assets/css/reset.css">
    <link rel="stylesheet" href="./assets/css/variables.css">
    <link rel="stylesheet" href="./assets/css/voz.css">
    <link rel="stylesheet" href="./assets/css/aurea-animacao.css">
    <link rel="stylesheet" href="./assets/css/painel-acessibilidade.css">
    <link rel="stylesheet" href="./assets/css/filtros-acessibilidade.css">
    
    <!-- Import Map para módulos ES6 -->
    <script type="importmap">
    {
        "imports": {
            "@google/genai": "https://esm.sh/@google/genai@1.15.0/web"
        }
    }
    </script>
</head>
<body>
    <!-- Página de Conversa por Voz -->
    <main class="pagina-voz">
        <!-- Cabeçalho -->
        <header class="cabecalho">
            <a href="paginainicial.html" aria-label="Voltar para página inicial">
                <button 
                    class="botao-voltar" 
                    type="button">
                    <svg width="10" height="19" viewBox="0 0 10 19" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M9.25667 17.8117L0.75 9.28083L9.25667 0.75" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </button>
            </a>

            <h1 class="logo-senachat">SenaChat</h1>

            <button 
                class="botao-acessibilidade" 
                aria-label="Opções de acessibilidade"
                type="button">
                
                <svg width="1000" height="1000" viewBox="320 330 360 360" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M415.3 662.2C425.849 662.2 434.4 653.649 434.4 643.1C434.4 632.551 425.849 624 415.3 624C404.751 624 396.2 632.551 396.2 643.1C396.2 653.649 404.751 662.2 415.3 662.2Z" stroke="currentColor" stroke-width="8" stroke-miterlimit="10"/>
                    <path d="M584.7 662.2C595.249 662.2 603.8 653.649 603.8 643.1C603.8 632.551 595.249 624 584.7 624C574.151 624 565.6 632.551 565.6 643.1C565.6 653.649 574.151 662.2 584.7 662.2Z" stroke="currentColor" stroke-width="8" stroke-miterlimit="10"/>
                    <path d="M652 487.2C662.549 487.2 671.1 478.649 671.1 468.1C671.1 457.551 662.549 449 652 449C641.451 449 632.9 457.551 632.9 468.1C632.9 478.649 641.451 487.2 652 487.2Z" stroke="currentColor" stroke-width="8" stroke-miterlimit="10"/>
                    <path d="M348 487.2C358.549 487.2 367.1 478.649 367.1 468.1C367.1 457.551 358.549 449 348 449C337.451 449 328.9 457.551 328.9 468.1C328.9 478.649 337.451 487.2 348 487.2Z" stroke="currentColor" stroke-width="8" stroke-miterlimit="10"/>
                    <path d="M366.6 480.6C388.4 492.8 438.7 516.9 506.4 515.3C566.8 513.9 611.7 492.7 633.4 480.6" stroke="currentColor" stroke-width="8" stroke-miterlimit="10"/>
                    <path d="M427.2 627.4C451.5 590.1 475.7 552.7 500 515.4" stroke="currentColor" stroke-width="8" stroke-miterlimit="10"/>
                    <path d="M572.8 627.4C548.5 590.1 524.3 552.7 500 515.4" stroke="currentColor" stroke-width="8" stroke-miterlimit="10"/>
                    <path d="M500 477.5C523.527 477.5 542.6 458.427 542.6 434.9C542.6 411.373 523.527 392.3 500 392.3C476.473 392.3 457.4 411.373 457.4 434.9C457.4 458.427 476.473 477.5 500 477.5Z" stroke="currentColor" stroke-width="8" stroke-miterlimit="10"/>
                    <path d="M360.6 434.9C388.7 384.6 441.8 353.2 499.3 353C557.3 352.8 611.1 384.2 639.4 434.9" stroke="currentColor" stroke-width="8" stroke-miterlimit="10"/>
                    <path d="M343.7 500C342.3 513.1 341.5 537.5 351.4 565.5C362 595.5 379.5 614.7 389.2 624" stroke="currentColor" stroke-width="8" stroke-miterlimit="10"/>
                    <path d="M656.3 500C657.7 513.1 658.5 537.5 648.6 565.5C638 595.5 620.5 614.7 610.8 624" stroke="currentColor" stroke-width="8" stroke-miterlimit="10"/>
                    <path d="M445.1 657.3C456.1 662.3 477.4 670.3 505.1 669.2C527.3 668.3 544.6 662 554.9 657.3" stroke="currentColor" stroke-width="8" stroke-miterlimit="10"/>
                </svg>
                    
            </button>
        </header>

        <!-- Área de Mensagens/Transcrição -->
        <section class="area-conversa" aria-live="polite" aria-atomic="true">
            <div class="container-mensagens" id="containerMensagens">
                <!-- Mensagens aparecerão aqui dinamicamente -->
                <div class="mensagem-inicial">
                    <p class="texto-inicial">Toque no microfone e comece a falar</p>
                </div>
            </div>
        </section>

        <section class="aurea-senachat">
            <svg width="450" height="350" viewBox="0 0 229 214" fill="none" xmlns="http://www.w3.org/2000/svg">
                <rect width="22.5241" height="57.6616" rx="11.262" transform="matrix(-0.5 0.866025 0.866025 0.5 167.555 46.2619)" fill="url(#paint0_linear_0_1)"/>
                <rect x="198.084" y="64.1987" width="22.5241" height="57.6616" rx="11.262" transform="rotate(30 198.084 64.1987)" fill="url(#paint1_linear_0_1)"/>
                <rect width="22.5241" height="57.6616" rx="11.262" transform="matrix(0.866025 -0.5 -0.5 -0.866025 39.3836 126.289)" fill="url(#paint2_linear_0_1)"/>
                <rect x="21.9135" y="95.4905" width="22.5241" height="57.6616" rx="11.262" transform="rotate(-120 21.9135 95.4905)" fill="url(#paint3_linear_0_1)"/>
                <rect width="22.5241" height="57.6616" rx="11.262" transform="matrix(0.707107 0.707107 0.707107 -0.707107 72.9655 40.7729)" fill="url(#paint4_linear_0_1)"/>
                <rect x="98.1925" y="15.9269" width="22.5241" height="57.6616" rx="11.262" transform="rotate(-45 98.1925 15.9269)" fill="url(#paint5_linear_0_1)"/>
                <rect width="22.5241" height="57.6616" rx="11.262" transform="matrix(-0.258819 -0.965926 -0.965926 0.258819 110.167 178.333)" fill="url(#paint6_linear_0_1)"/>
                <rect x="75.8967" y="187.237" width="22.5241" height="57.6616" rx="11.262" transform="rotate(165 75.8967 187.237)" fill="url(#paint7_linear_0_1)"/>
                <rect width="22.5241" height="57.6616" rx="11.262" transform="matrix(-0.965926 -0.258819 -0.258819 0.965926 188.758 137.143)" fill="url(#paint8_linear_0_1)"/>
                <rect x="179.334" y="171.273" width="22.5241" height="57.6616" rx="11.262" transform="rotate(105 179.334 171.273)" fill="url(#paint9_linear_0_1)"/>
                <circle cx="114.643" cy="199.366" r="6" stroke="#FE29BB"/>
                <circle cx="211.643" cy="133.366" r="6" stroke="#FE29BB"/>
                <circle cx="95.143" cy="106.581" r="4.5" transform="rotate(-90 95.143 106.581)" stroke="#FE29BB"/>
                <circle cx="95.143" cy="68.9213" r="4.5" transform="rotate(-90 95.143 68.9213)" stroke="#FE29BB"/>
                <circle cx="77.0845" cy="86.2783" r="5.97274" transform="rotate(-90 77.0845 86.2783)" stroke="#FE29BB"/>
                <circle cx="113.567" cy="86.2783" r="5.97274" transform="rotate(-90 113.567 86.2783)" stroke="#FE29BB"/>
                <circle cx="132.143" cy="106.581" r="4.5" transform="rotate(-90 132.143 106.581)" stroke="#FE29BB"/>
                <circle cx="132.143" cy="68.9213" r="4.5" transform="rotate(-90 132.143 68.9213)" stroke="#FE29BB"/>
                <circle cx="150.05" cy="86.2783" r="5.97274" transform="rotate(-90 150.05 86.2783)" stroke="#FE29BB"/>
                <circle cx="95.4415" cy="144.24" r="4.5" transform="rotate(-90 95.4415 144.24)" stroke="#FE29BB"/>
                <circle cx="77.0845" cy="123.938" r="5.97274" transform="rotate(-90 77.0845 123.938)" stroke="#FE29BB"/>
                <circle cx="113.567" cy="123.938" r="5.97274" transform="rotate(-90 113.567 123.938)" stroke="#FE29BB"/>
                <circle cx="131.924" cy="144.24" r="4.5" transform="rotate(-90 131.924 144.24)" stroke="#FE29BB"/>
                <circle cx="150.05" cy="123.938" r="5.97274" transform="rotate(-90 150.05 123.938)" stroke="#FE29BB"/>
                <circle cx="16.643" cy="133.366" r="6" stroke="#FE29BB"/>
                <circle cx="169.643" cy="32.3657" r="6" stroke="#FE29BB"/>
                <circle cx="58.643" cy="32.3657" r="6" stroke="#FE29BB"/>
                <defs>
                <linearGradient id="paint0_linear_0_1" x1="11.262" y1="0" x2="11.262" y2="57.6616" gradientUnits="userSpaceOnUse">
                <stop stop-color="#7A01FF"/>
                <stop offset="1" stop-color="#FE29BB"/>
                </linearGradient>
                <linearGradient id="paint1_linear_0_1" x1="209.346" y1="64.1987" x2="209.346" y2="121.86" gradientUnits="userSpaceOnUse">
                <stop stop-color="#FE29BB"/>
                <stop offset="1" stop-color="#FF8C9D"/>
                </linearGradient>
                <linearGradient id="paint2_linear_0_1" x1="11.262" y1="0" x2="11.262" y2="57.6616" gradientUnits="userSpaceOnUse">
                <stop stop-color="#7A01FF"/>
                <stop offset="1" stop-color="#FE29BB"/>
                </linearGradient>
                <linearGradient id="paint3_linear_0_1" x1="33.1755" y1="95.4905" x2="33.1755" y2="153.152" gradientUnits="userSpaceOnUse">
                <stop stop-color="#FE29BB"/>
                <stop offset="1" stop-color="#FF8C9D"/>
                </linearGradient>
                <linearGradient id="paint4_linear_0_1" x1="11.262" y1="0" x2="11.262" y2="57.6616" gradientUnits="userSpaceOnUse">
                <stop stop-color="#7A01FF"/>
                <stop offset="1" stop-color="#FE29BB"/>
                </linearGradient>
                <linearGradient id="paint5_linear_0_1" x1="109.454" y1="15.9269" x2="109.454" y2="73.5885" gradientUnits="userSpaceOnUse">
                <stop stop-color="#FE29BB"/>
                <stop offset="1" stop-color="#FF8C9D"/>
                </linearGradient>
                <linearGradient id="paint6_linear_0_1" x1="11.262" y1="0" x2="11.262" y2="57.6616" gradientUnits="userSpaceOnUse">
                <stop stop-color="#7A01FF"/>
                <stop offset="1" stop-color="#FE29BB"/>
                </linearGradient>
                <linearGradient id="paint7_linear_0_1" x1="87.1588" y1="187.237" x2="87.1588" y2="244.898" gradientUnits="userSpaceOnUse">
                <stop stop-color="#FE29BB"/>
                <stop offset="1" stop-color="#FF8C9D"/>
                </linearGradient>
                <linearGradient id="paint8_linear_0_1" x1="11.262" y1="0" x2="11.262" y2="57.6616" gradientUnits="userSpaceOnUse">
                <stop stop-color="#7A01FF"/>
                <stop offset="1" stop-color="#FE29BB"/>
                </linearGradient>
                <linearGradient id="paint9_linear_0_1" x1="190.596" y1="171.273" x2="190.596" y2="228.935" gradientUnits="userSpaceOnUse">
                <stop stop-color="#FE29BB"/>
                <stop offset="1" stop-color="#FF8C9D"/>
                </linearGradient>
                </defs>
            </svg>

        </section>

        <!-- Controle de Voz -->
        <section class="area-controle-voz">
            <div class="indicador-audio" id="indicadorAudio" aria-hidden="true">
                <div class="onda-audio"></div>
                <div class="onda-audio"></div>
                <div class="onda-audio"></div>
                <div class="onda-audio"></div>
                <div class="onda-audio"></div>
            </div>

            <button 
                class="botao-microfone" 
                id="botaoMicrofone"
                aria-label="Pressione para falar"
                type="button">
                <div class="circulo-externo"></div>
                <div class="circulo-interno">
                    <svg class="icone-microfone" width="50" height="50" viewBox="0 0 50 50" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M25 32.2916C29.6041 32.2916 33.3333 28.5625 33.3333 23.9583V12.5C33.3333 7.89579 29.6041 4.16663 25 4.16663C20.3958 4.16663 16.6666 7.89579 16.6666 12.5V23.9583C16.6666 28.5625 20.3958 32.2916 25 32.2916Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M9.0625 20.1042V23.6459C9.0625 32.4376 16.2083 39.5834 25 39.5834C33.7917 39.5834 40.9375 32.4376 40.9375 23.6459V20.1042" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M22.1041 13.3959C23.9791 12.7084 26.0208 12.7084 27.8958 13.3959" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M23.3334 17.8124C24.4375 17.5207 25.5834 17.5207 26.6875 17.8124" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M25 39.5834V45.8334" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
            </button>

            <p class="status-gravacao" id="statusGravacao">Toque para falar</p>
        </section>
    </main>

    <!-- Scripts -->
    <script src="./assets/js/acessibilidade-global.js"></script>
    <script src="./assets/js/aurea-animacao.js"></script>
    <script type="module" src="./assets/js/voz.js"></script>

    <div vw class="enabled">
    <div vw-access-button class="active"></div>
    <div vw-plugin-wrapper>
        <div class="vw-plugin-top-wrapper"></div>
    </div>
</div>
<script src="https://vlibras.gov.br/app/vlibras-plugin.js"></script>
<script>
    new window.VLibras.Widget('https://vlibras.gov.br/app');
</script>
</body>
</html>
